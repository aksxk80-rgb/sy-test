<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>개인전 스코어보드</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    .card { border: 1px solid #ccc; padding: 10px; margin: 10px 0; cursor: pointer; }
    .card:hover { background: #f0f0f0; }
  </style>
</head>
<body>
  <h1>2026 개인전 스코어보드</h1>
  <div id="status">데이터 로딩 중...</div>
  <div id="board"></div>

  <script>
    const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQEXAMPLE2026/pub?output=csv"; // 여기에 실제 시트 URL 넣기

    fetch(sheetUrl)
      .then(res => res.text())
      .then(text => {
        const rows = text.trim().split("\n").map(row => row.split(","));
        const header = rows[0];
        const nameIdx = header.indexOf("이름");
        const rankIdx = header.indexOf("순위");
        const totalIdx = header.indexOf("총점");

        const items = rows.slice(1).map(cols => {
          const name = cols[nameIdx]?.trim();
          const rank = cols[rankIdx]?.trim();
          const total = cols[totalIdx]?.trim();
          if (!rank || !name) return null;
          return {
            rank: Number(rank),
            displayName: name,
            teamKeyName: name,
            score: total,
            total
          };
        }).filter(Boolean).sort((a, b) => a.rank - b.rank);

        const boardEl = document.getElementById("board");
        const statusEl = document.getElementById("status");
        boardEl.innerHTML = "";
        statusEl.textContent = "";

        if (!items.length) {
          statusEl.textContent = "표시할 데이터가 없습니다.";
          return;
        }

        items.forEach(item => {
          const card = document.createElement("div");
          card.className = "card";
          card.innerHTML = `<strong>${item.rank}위</strong> - ${item.displayName} (${item.total}점)`;
          card.onclick = () => {
            window.location.href = `/sy-test/2026/merryclimb_detail.html?team=${encodeURIComponent(item.teamKeyName)}`;
          };
          boardEl.appendChild(card);
        });
      });
  </script>
</body>
</html>
